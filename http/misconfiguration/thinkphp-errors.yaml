id: thinkphp-errors
info:
  name: ThinkPHP Errors - Sensitive Information Exposure
  author: j4vaovo
  severity: medium
  metadata:
    max-request: 1
    verified: 'true'
    fofa-query: app="ThinkPHP" && title="System Error"
  tags: thinkphp,misconfig,exposure
  description: ThinkPHP Errors - Sensitive Information Exposure detected
http:
- method: GET
  path:
  - '{{BaseURL}}'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - _DATABASE</td>
    - _USERNAME</td>
    - _PASSWORD</td>
    condition: and
  - type: word
    part: body
    words:
    - "<title>\u7CFB\u7EDF\u53D1\u751F\u9519\u8BEF</title>"
    - <title>System Error</title>
    condition: or
  - type: word
    part: body
    words:
    - Exception
    - REQUEST_TIME
    condition: and
  - type: status
    status:
    - 200
    - 500
    - 404
    condition: or
